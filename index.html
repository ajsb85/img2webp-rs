<!DOCTYPE html>
<html lang="en" class="spectrum spectrum--light spectrum--medium">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebP Animation Optimization Benchmarks | img2webp-rs</title>

    <!-- Spectrum CSS Tokens -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@spectrum-css/tokens@latest/dist/spectrum-global.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@spectrum-css/tokens@latest/dist/spectrum-medium.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@spectrum-css/tokens@latest/dist/spectrum-light.css">

    <!-- Spectrum CSS Standalone Bundle -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@adobe/spectrum-css@latest/dist/standalone/spectrum-css-standalone.min.css">

    <style>
        body {
            margin: 0;
            padding: 40px;
            background-color: var(--spectrum-global-color-gray-100);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header-section {
            text-align: center;
            margin-bottom: 40px;
            max-width: 800px;
        }

        .controls-container {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
            justify-content: center;
            padding: 16px;
            background: var(--spectrum-global-color-gray-50);
            border-radius: var(--spectrum-global-dimension-static-size-100);
            box-shadow: var(--spectrum-global-dimension-static-size-10) var(--spectrum-global-dimension-static-size-10) var(--spectrum-global-dimension-static-size-40) rgba(0,0,0,0.05);
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
            gap: 32px;
            width: 100%;
            max-width: 1200px;
        }

        /* Custom Card Preview area to house the backgrounds */
        .benchmark-preview {
            position: relative;
            height: 240px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid var(--spectrum-global-color-gray-200);
            overflow: hidden;
            background-size: 20px 20px;
        }

        /* Background Types */
        .checkered {
            background-image:
                linear-gradient(45deg, #ccc 25%, transparent 25%),
                linear-gradient(-45deg, #ccc 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #ccc 75%),
                linear-gradient(-45deg, transparent 75%, #ccc 75%);
            background-size: 40px 40px;
            background-position: 0 0, 0 20px, 20px -20px, -20px 0px;
        }
        .image-bg {
            background-image: url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=800&q=80');
            background-size: cover;
        }
        .solid-bg { background: #2c3e50; }
        .black-bg { background: #000000; }
        
        .benchmark-image {
            max-width: 90%;
            max-height: 90%;
            display: block;
        }
        
        .pixelated { image-rendering: pixelated; }

        .deep-dive-section {
            margin-top: 60px;
            max-width: 800px;
            width: 100%;
        }

        .stats-label {
            font-weight: bold;
            color: var(--spectrum-global-color-gray-700);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body class="spectrum-Body">

    <div class="header-section">
        <h1 class="spectrum-Heading spectrum-Heading--sizeXXL">WebP Animation Benchmarks</h1>
        <p class="spectrum-Body--sizeL">Experimental results from <code>img2webp-rs</code> showcasing transparency handling and optimization strategies.</p>
        
        <div class="controls-container">
            <div class="control-group">
                <span class="spectrum-Detail spectrum-Detail--sizeS">BACKGROUND</span>
                <button class="spectrum-ActionButton spectrum-ActionButton--quiet" onclick="setBg('checkered')">
                    <span class="spectrum-ActionButton-label">Checkered</span>
                </button>
                <button class="spectrum-ActionButton spectrum-ActionButton--quiet" onclick="setBg('image-bg')">
                    <span class="spectrum-ActionButton-label">Nature</span>
                </button>
                <button class="spectrum-ActionButton spectrum-ActionButton--quiet" onclick="setBg('solid-bg')">
                    <span class="spectrum-ActionButton-label">Solid Dark</span>
                </button>
                <button class="spectrum-ActionButton spectrum-ActionButton--quiet" onclick="setBg('black-bg')">
                    <span class="spectrum-ActionButton-label">Solid Black</span>
                </button>
            </div>
            <div class="spectrum-Divider spectrum-Divider--vertical" style="height: 24px;"></div>
            <div class="control-group">
                <span class="spectrum-Detail spectrum-Detail--sizeS">RENDERING</span>
                <button class="spectrum-ActionButton spectrum-ActionButton--quiet" onclick="setRendering('smooth')">
                    <span class="spectrum-ActionButton-label">Smooth</span>
                </button>
                <button class="spectrum-ActionButton spectrum-ActionButton--quiet" onclick="setRendering('pixelated')">
                    <span class="spectrum-ActionButton-label">Pixel Perfect</span>
                </button>
            </div>
        </div>
    </div>

    <div class="demo-grid">
        <!-- Standard -->
        <div class="spectrum-Card">
            <div class="benchmark-preview checkered"><img src="animated.webp" class="benchmark-image"></div>
            <div class="spectrum-Card-body">
                <div class="spectrum-Card-header">
                    <div class="spectrum-Card-title">Standard</div>
                </div>
                <div class="spectrum-Card-description">Default lossless behavior. Good balance.</div>
                <div class="spectrum-Body--sizeS" style="margin-top: 12px;">
                    <span class="stats-label">Size:</span> 1.31 MB<br>
                    <span class="stats-label">Flags:</span> Default (Lossless)
                </div>
            </div>
        </div>

        <!-- Pixel Perfect -->
        <div class="spectrum-Card">
            <div class="benchmark-preview checkered"><img src="animated_perfect.webp" class="benchmark-image"></div>
            <div class="spectrum-Card-body">
                <div class="spectrum-Card-header">
                    <div class="spectrum-Card-title">Pixel Perfect</div>
                </div>
                <div class="spectrum-Card-description">Preserves RGB under transparency.</div>
                <div class="spectrum-Body--sizeS" style="margin-top: 12px;">
                    <span class="stats-label">Size:</span> 1.40 MB<br>
                    <span class="stats-label">Flags:</span> <code>-lossless -exact</code>
                </div>
            </div>
        </div>

        <!-- Extreme Slow -->
        <div class="spectrum-Card">
            <div class="benchmark-preview checkered"><img src="animated_slowest.webp" class="benchmark-image"></div>
            <div class="spectrum-Card-body">
                <div class="spectrum-Card-header">
                    <div class="spectrum-Card-title">Extreme Slow</div>
                </div>
                <div class="spectrum-Card-description">Maximum search effort for small size.</div>
                <div class="spectrum-Body--sizeS" style="margin-top: 12px;">
                    <span class="stats-label">Size:</span> 1.38 MB<br>
                    <span class="stats-label">Flags:</span> <code>-m 6 -alpha_filter 2 -exact</code>
                </div>
            </div>
        </div>

        <!-- Optimized Small -->
        <div class="spectrum-Card">
            <div class="benchmark-preview checkered"><img src="animated_small.webp" class="benchmark-image"></div>
            <div class="spectrum-Card-body">
                <div class="spectrum-Card-header">
                    <div class="spectrum-Card-title">Optimized Small</div>
                </div>
                <div class="spectrum-Card-description">Aggressive compression for assets.</div>
                <div class="spectrum-Body--sizeS" style="margin-top: 12px;">
                    <span class="stats-label">Size:</span> 203 KB<br>
                    <span class="stats-label">Flags:</span> <code>-min_size -mixed -alpha_q 50</code>
                </div>
            </div>
        </div>

        <!-- Near Lossless -->
        <div class="spectrum-Card">
            <div class="benchmark-preview checkered"><img src="animated_near_lossless60.webp" class="benchmark-image"></div>
            <div class="spectrum-Card-body">
                <div class="spectrum-Card-header">
                    <div class="spectrum-Card-title">Near Lossless (60)</div>
                </div>
                <div class="spectrum-Card-description">Visually identical, technically lossy.</div>
                <div class="spectrum-Body--sizeS" style="margin-top: 12px;">
                    <span class="stats-label">Size:</span> 895 KB<br>
                    <span class="stats-label">Flags:</span> <code>-near_lossless 60</code>
                </div>
            </div>
        </div>

        <!-- Lossy Low Quality -->
        <div class="spectrum-Card">
            <div class="benchmark-preview checkered"><img src="animated_lossy_low.webp" class="benchmark-image"></div>
            <div class="spectrum-Card-body">
                <div class="spectrum-Card-header">
                    <div class="spectrum-Card-title">Lossy Low Quality</div>
                </div>
                <div class="spectrum-Card-description">Minimal footprint for bandwidth limits.</div>
                <div class="spectrum-Body--sizeS" style="margin-top: 12px;">
                    <span class="stats-label">Size:</span> 125 KB<br>
                    <span class="stats-label">Flags:</span> <code>-lossy -q 30 -alpha_q 30</code>
                </div>
            </div>
        </div>
    </div>

    <div class="deep-dive-section">
        <h2 class="spectrum-Heading spectrum-Heading--sizeM">Deep Dive: Optimization Matrix</h2>
        <div class="spectrum-Divider spectrum-Divider--sizeM" style="margin-bottom: 24px;"></div>
        
        <p class="spectrum-Body--sizeM">
            By exploring the <code>WebPConfig</code> headers and the <code>libwebp</code> implementation, we identified several advanced optimization vectors:
        </p>

        <ul class="spectrum-Body--sizeM">
            <li><strong>Alpha Compression Method:</strong> Switches between no compression and lossless compression for the alpha channel. Our tool now exposes this.</li>
            <li><strong>Alpha Filtering:</strong> "Best" uses complex predictive filtering that significantly improves compression of smooth alpha gradients.</li>
            <li><strong>Method Search:</strong> Controls the complexity of the compression search. Level 6 is the "Enterprise Grade" setting for maximum compression.</li>
            <li><strong>Sharp YUV:</strong> A more accurate RGB to YUV conversion that reduces artifacts at high-contrast edges.</li>
            <li><strong>Mixed Mode:</strong> Allows the encoder to decide frame-by-frame whether lossless or lossy is better.</li>
            <li><strong>Near Lossless:</strong> Slightly adjusts pixel values to achieve much better compression while appearing nearly identical to the source.</li>
        </ul>
    </div>

    <script>
        function setBg(cls) {
            document.querySelectorAll('.benchmark-preview').forEach(el => {
                el.className = 'benchmark-preview ' + cls;
            });
        }
        function setRendering(cls) {
            document.querySelectorAll('.benchmark-image').forEach(el => {
                el.className = 'benchmark-image ' + cls;
            });
        }
    </script>
</body>
</html>